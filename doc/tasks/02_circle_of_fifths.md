# 五度圏表（サークル・オブ・フィフス）によるコード選択インターフェース 実装タスク

## 概要
コード進行作成機能の一部として、五度圏表を使ったコード選択インターフェースを実装します。
これにより、ユーザーは音楽理論に基づいた視覚的・直感的なコード選択が可能になります。

## 実装タスク

### 1. データモデルの実装
- [x] **五度圏データモデルの定義**
  - [x] 12の調（C, G, D, A, E, B, F#/Gb, Db, Ab, Eb, Bb, F）の関係を定義
  - [x] 各調のメジャーコードとその平行調のマイナーコードの関係を定義
  - [x] 各コードの色分け用のカラーマッピングの定義

- [x] **コード情報の拡張**
  - [x] 既存の`chords.ts`に五度圏上での位置情報を追加
  - [x] 関連コード（平行調、副属和音など）の関係性情報を追加

### 2. CircleOfFifths コンポーネントの実装
- [x] **基本構造の設計**
  - [x] SVGを使用した円形レイアウトの実装
  - [x] 12の調の配置（円周上の正確な位置の計算）
  - [x] メジャーとマイナーコードの内外円表示

- [x] **視覚的デザイン実装**
  - [x] コードのカラーコーディング
  - [x] 選択状態の視覚的フィードバック
  - [x] 関連コードのハイライト表示

- [ ] **レスポンシブ対応**
  - [x] 基本的なレスポンシブ対応
  - [ ] モバイルデバイス対応（タッチ操作の最適化）

### 3. インタラクション機能の実装
- [x] **コード選択機能**
  - [x] クリック/タップでのコード選択
  - [x] 選択したコードの情報取得と状態管理

- [x] **選択コードの試聴機能**
  - [x] 既存の`audioEngine.ts`との連携
  - [x] 選択したコードの音の再生

- [x] **関連コードの表示**
  - [x] 選択コードに基づく関連コードのハイライト
  - [ ] 調性に基づく次のコード提案表示（今後の拡張機能）

### 4. コード詳細表示の実装
- [x] **詳細情報パネルの作成**
  - [x] 選択コードの構成音表示
  - [ ] コード機能（トニック、ドミナントなど）の説明（今後の拡張機能）
  - [ ] コード理論の簡易解説表示（今後の拡張機能）

- [ ] **コード構成音の可視化**
  - [ ] 構成音のピアノキーボードや譜面での表示（今後の拡張機能）
  - [ ] コード内の各音の役割説明（ルート、サード、フィフスなど）（今後の拡張機能）

### 5. ChordSelector との統合
- [x] **既存コンポーネントとの連携**
  - [x] `ChordSelector.tsx`コンポーネントへの五度圏表示の組み込み
  - [x] 表示モード切替機能（リスト表示⇔五度圏表示）

- [ ] **コード進行エディタとの連携**
  - [ ] 選択したコードの進行への追加（今後の実装予定）
  - [ ] 進行内の現在位置との関連性表示（今後の実装予定）

### 6. 初心者向けヘルプ機能
- [x] **五度圏の説明機能**
  - [x] 簡易的なヘルプテキスト表示
  - [ ] 詳細なチュートリアル表示（今後の拡張機能）
  - [ ] ツールチップによる各要素の説明（今後の拡張機能）

- [ ] **コード進行理論のヒント**
  - [ ] 一般的なコード進行パターンの表示（今後の拡張機能）
  - [ ] 選択中のコードからの進行提案（今後の拡張機能）

### 7. テストとQA
- [ ] **単体テストの実装**
  - [ ] 各コンポーネントの機能テスト（今後の実装予定）
  - [ ] エッジケースの検証（今後の実装予定）

- [ ] **ユーザビリティテスト**
  - [ ] 操作性の検証（今後の実装予定）
  - [ ] フィードバックに基づく改善（今後の実装予定）

## 技術スタック
- [x] React + TypeScript
- [x] SVG（五度圏の描画）
- [x] TailwindCSS（レスポンシブデザイン）
- [x] Tone.js（コード再生）

## 成果物
1. [x] `CircleOfFifths.tsx` - メインコンポーネント
2. [x] `circleOfFifths.ts` - データモデルと関連ロジック
3. [ ] 専用のCSSファイルは不要（TailwindCSSを使用）
4. [x] ChordSelectorへの統合コード

## 実装状況サマリー
- **完了**: 基本的なデータモデル、SVG表示、コード選択機能、ChordSelectorとの統合
- **部分的に完了**: レスポンシブ対応、コード詳細表示、ヘルプ機能
- **未実装**: モバイル最適化、詳細なコード理論表示、コード進行エディタとの連携、テスト

## 次のステップ
1. モバイルデバイス向け最適化
2. コード理論の詳細表示機能
3. コード進行提案機能の追加
4. テストケースの作成と実行
